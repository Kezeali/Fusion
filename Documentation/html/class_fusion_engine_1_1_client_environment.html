<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Fusion: FusionEngine::ClientEnvironment Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="namespace_fusion_engine.html">FusionEngine</a>::<a class="el" href="class_fusion_engine_1_1_client_environment.html">ClientEnvironment</a></div>
<h1>FusionEngine::ClientEnvironment Class Reference</h1><!-- doxytag: class="FusionEngine::ClientEnvironment" -->The client gameplay environment.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;FusionClientEnvironment.h&gt;</code>
<p>
<a href="class_fusion_engine_1_1_client_environment-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fusion_engine_1_1_client_environment.html#d8d63d5b553836c616ba0a471970bd37">Update</a> (unsigned int split)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Does everything.  <a href="#d8d63d5b553836c616ba0a471970bd37"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7ecc9c588d76db0ed3992bb512b93fd9"></a><!-- doxytag: member="FusionEngine::ClientEnvironment::GetShipResourceByID" ref="7ecc9c588d76db0ed3992bb512b93fd9" args="(std::string id) const " -->
const <a class="el" href="class_fusion_engine_1_1_ship_resource.html">ShipResource</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fusion_engine_1_1_client_environment.html#7ecc9c588d76db0ed3992bb512b93fd9">GetShipResourceByID</a> (std::string id) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called by <a class="el" href="class_fusion_engine_1_1_fusion_ship_drawable.html#f4af9fbdcd65e99b2eef701a21f3aef9">FusionShipDrawable::Draw()</a> to get the sprite, etc. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The client gameplay environment. 
<p>
This is where all the gameplay stuff goes on at the client-side. Moving / drawing ships, syncing with server, prediction, etc. is all controlled from here. That isn't to say just this one class does all thoes things, this class just controlls the activities of other, more specific classes which do.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_fusion_engine_1_1_fusion_scene.html">FusionScene</a> | <a class="el" href="class_fusion_engine_1_1_fusion_input.html">FusionInput</a> | FusionNetworkingHandler. </dd></dl>

<p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="d8d63d5b553836c616ba0a471970bd37"></a><!-- doxytag: member="FusionEngine::ClientEnvironment::Update" ref="d8d63d5b553836c616ba0a471970bd37" args="(unsigned int split)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ClientEnvironment::Update           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>split</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Does everything. 
<p>
Actually, this function just does the following:<ol type=1>
<li>Queries <a class="el" href="class_fusion_engine_1_1_fusion_input.html">FusionInput</a> for input data</li><li>Queries FusionNetwork for new messages.</li><li>Updates the state of all objects based on any frames received. It does this by finding the time of the received frame in the history, then interpolating between the closest stored frames to that time, to check if the local movements match up with the remote ones. If they don't, the gameplay is run through again from that point (without drawing of course!), using the new frame and any input from subsiquent keyframes (where the input changed) in that time period, to place the object at the correct position.</li><li>Updates the positions of all objects based on their current state / inputs. This provides pridictive movement if no new frames were received.</li><li>Using their current state and inputs in the prevoius steps, it builds a new frame for each local ship.</li><li>Decides whether enough time has passed to allow an update, and adds the current frame of each ship to the message queue and history if it has.</li><li>Sends everything in the message queue (this may include non-gameplay messages added to the queue by other threads (eg from the console and chat) too, but we don't care about them - I may even give them their own queue and/or socket).</li><li>Sets the positions of the ship nodes by calling UpdateNode on each ship.</li><li>Updates the positions of all non-synced objects (this doesn't include weapons, engines, etc. because those are child nodes and moved with their parents.)</li></ol>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>split</em>&nbsp;</td><td>The amount of time since <a class="el" href="class_fusion_engine_1_1_client_environment.html#d8d63d5b553836c616ba0a471970bd37">ClientEnvironment::Update()</a> was lass called. </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>/Volumes/back3/code/Fusion/FusionEngine/FusionClientEnvironment.h<li>/Volumes/back3/code/Fusion/FusionEngine/FusionClientEnvironment.cpp</ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Sep 21 14:03:50 2006 for Fusion by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
